<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<link rel="stylesheet" href="../y引入/common/layui/css/layui.css">
<link rel="stylesheet" href="./list.css">

<body>
    <div class="box">
        <div class="todolist">
            <div class="todolist-title">
                <h3>待办事项</h3>
            </div>
            <div class="tododi">
            </div>

        </div>
        <div class="newadd">
            <div class="newadd-left">
                <div class="newadd-title">
                    <h3>新增会员</h3>
                    <li id="jinsa">近30日</li>
                    <li id="jinq">近七日</li>
                    <li id="houtia">后天</li>
                    <li id="tododa">今天</li>
                </div>
                <div class="xiantu">
                </div>
            </div>
            <div class="newadd-left">
                <div class="newadd-title">
                    <h3>新增订单</h3>
                    <li id="jinsan">近30日</li>
                    <li id="jinqi">近七日</li>
                    <li id="houtian">后天</li>
                    <li id="tododay">今天</li>
                </div>
                <div class="zhuangtu">
                </div>
            </div>
        </div>
        <div class="Operational">
            <div class="Operational-title">
                <h3>运营数据</h3>
                <div class="date">
                    <!-- <div class="layui-inline">
                        <div class="layui-input-inline">
                            <input type="text" class="layui-input" id="ID-laydate-demo" placeholder="yyyy-MM-dd">
                        </div>
                    </div> -->
                    <input type="date">
                    <input type="date">
                    <ul>
                        <li>近30日</li>
                        <li>近7日</li>
                        <li>昨日</li>
                        <li>今日</li>
                    </ul>
                </div>

            </div>
            <div class="operate">
                <div class="operate-left">
                    <div class="operate-one">
                        <p>成交金额(元)</p>
                        <h2>4218.1</h2>
                    </div>
                    <div class="operate-one">
                        <p>退款金额(元)</p>
                        <h2>455</h2>
                    </div>
                    <div class="operate-one">
                        <p>支付订单数(笔)</p>
                        <h2>32</h2>
                    </div>
                    <div class="operate-one">
                        <p>支付人数(人)</p>
                        <h2>27</h2>
                    </div>
                    <div class="operate-one">
                        <p>客单价(元)</p>
                        <h2>156.22</h2>
                    </div>
                    <div class="operate-one">
                        <p>笔单价(元)</p>
                        <h2>131.81</h2>
                    </div>
                </div>
                <div class="operate-right">

                </div>
            </div>
        </div>
        <div class="newadd">
            <div class="newadd-left">
                <div class="newadd-title">
                    <h3>新增分销订单</h3>
                    <li>近30日</li>
                    <li>近七日</li>
                    <li>后天</li>
                    <li>今天</li>
                </div>
                <div class="zhuzhaungtu">
                </div>
            </div>
            <div class="newadd-left">
                <div class="newadd-title">
                    <h3>新增分销商</h3>
                    <li>近30日</li>
                    <li>近七日</li>
                    <li>后天</li>
                    <li>今天</li>
                </div>
                <div class="bingtu">
                </div>
            </div>
        </div>
        <div class="flow">
            <div class="flow-title">
                <h3>浏览量分析</h3>
                <ul>
                    <li>近30日</li>
                    <li>近7日</li>
                    <li>后天</li>
                    <li>今天</li>
                </ul>
            </div>
            <div class="flowbo">
                <div class="flow-left">
                    <div class="flow-one">
                        <div class="color"></div>
                        <p>PV(总浏览量)</p>
                        <h2>4875</h2>
                    </div>
                    <div class="flow-one">
                        <div class="color"></div>
                        <p>UV(总访问量)</p>
                        <h2>310</h2>
                    </div>
                </div>
                <div class="flow-right">
                </div>
            </div>
        </div>
        <div class="Ranking">
            <div class="Ranking-left">
                <div class="Ranking-left-title">
                    <h3>商品排行</h3>
                    <ul>
                        <li>近30日</li>
                        <li>近7日</li>
                        <li>后天</li>
                        <li>今天</li>
                    </ul>
                </div>
                <div class="Rankingbo">
                    <div class="Rankingbo-title">
                        <p>全部商品排行</p>
                    </div>
                    <div class="RankingList">
                        <div class="RankingList-title">
                            <ul>
                                <li>排行</li>
                                <li>商品名称</li>
                                <li>统计销售数量</li>
                                <li>销售额</li>
                            </ul>
                        </div>
                        <div class="RankingList-coom">
                        </div>
                    </div>
                </div>
            </div>
            <div class="Ranking-right">
                <div class="Ranking-left-title">
                    <h3>会员排行</h3>
                    <ul>
                        <li>近30日</li>
                        <li>近7日</li>
                        <li>后天</li>
                        <li>今天</li>
                    </ul>
                </div>
                <div class="Rankingbo">
                    <div class="Rankingbo-title">
                        <p>全部会员排行</p>
                    </div>
                    <div class="RankingList">
                        <div class="Rankingright-title">
                            <ul>
                                <li>排行</li>
                                <li>用户</li>
                                <li>销售额</li>
                            </ul>
                        </div>
                        <div class="Rankingright-coom">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
<script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="../y引入/common/echars/echarts.min.js"></script>
<script src="../y引入/common/layui/layui.js"></script>

<script>

    const URL = "http://localhost:3000/shop"
    $(function () {
        shoplist()
        comlist()
        member()
    })
    //渲染
    function shoplist() {
        $.ajax({
            url: URL + "/list",
            type: "get",
            dataType: "json",
            success: function (res) {
                // console.log(res);
                // cardata = res
                let html = "";
                res.forEach((item, index) => {
                    html += ` <div class="todolist-one">
                    <h3>${item.title}</h3>
                    <p>${item.name}</p>
                    <h2>${item.quantity}</h2>
                </div>`
                });
                $(".tododi").html(html)
            }
        })
    }
    //  商品排行渲染
    function comlist() {
        $.ajax({
            url: URL + "/comlist",
            type: "get",
            dataType: "json",
            success: function (res) {
                // console.log(res);
                // cardata = res
                let html = "";
                res.forEach((item, index) => {
                    html += `<ul>
                                <li>1</i></li>
                                <li><img src="${item.img}"></li>
                                <li>${item.name}</li>
                                <li>${item.quantity}</li>
                                <li>￥${item.price}</li>
                            </ul>`
                });
                $(".RankingList-coom").html(html)
            }
        })
    }
    //  会员排行渲染
    function member() {
        $.ajax({
            url: URL + "/member",
            type: "get",
            dataType: "json",
            success: function (res) {
                // console.log(res);
                // cardata = res
                let html = "";
                res.forEach((item, index) => {
                    html += `<ul>
                                <li>1</i></li>
                                <li><img src="${item.img}"></li>
                                <li>${item.name}</li>
                                <li><img src ="${item.lj}" style="width:15px;height:15px;object-fit: cover;"></li>
                                <li>￥${item.price}</li>
                            </ul>`
                });
                $(".Rankingright-coom").html(html)
            }
        })
    }


</script>
<!-- 线图 -->
<script>
    var datalist
    var currentPage = 1
    var currentsize = 1
    var times = []
    $(function () {
        gethuiyuan();
        $('#tododa').click(tododa)
        $('#houtia').click(houtia)
        $('#jinq').click(jinq)
        $('#jinsa').click(jinsa)
    });

    function tododa() {
        currentPage = 1
        currentsize = 3
        time = []
        let data = {
            page: currentPage,
            size: currentsize,
        }
        gethuiyuan(data)
    }

    function houtia() {
        currentPage = 2
        currentsize = 7
        time = []

        let data = {
            page: currentPage,
            size: currentsize,
        }
        gethuiyuan(data)
    }

    function jinq() {
        currentPage = 1
        currentsize = 12
        time = []

        let data = {
            page: currentPage,
            size: currentsize,
        }
        gethuiyuan(data)
    }

    function jinsa() {
        currentPage = 1
        currentsize = 20
        time = []

        let data = {
            page: currentPage,
            size: currentsize,
        }
        gethuiyuan(data)
    }

    function gethuiyuan() {
        $.ajax({
            url: URL + "/huiyuan",
            type: "get",
            dataType: "json",
            success: function (res) {
                var datalist = res.map(item => Number(item.unit));
                res.forEach(item => {
                    if (item.c_time) {
                        times.push(item.c_time.substring(0, 10))
                    }
                })
                var myChart = echarts.init(document.querySelector('.xiantu'));
                var charts = {
                    unit: '单位(km)',
                    names: ['新增会员'],
                    lineX: times,
                    value: datalist
                };
                console.log(charts);

                var color = ['rgba(79, 237, 119']
                var lineY = []

                for (var i = 0; i < charts.names.length; i++) {
                    var x = i
                    if (x > color.length - 1) {
                        x = color.length - 1
                    }
                    var data = {
                        name: charts.names[i],
                        type: 'line',
                        color: color[x] + ')',
                        smooth: false,
                        areaStyle: {
                            normal: {
                                color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
                                    offset: 0,
                                    color: color[x] + ', 0.3)'
                                }, {
                                    offset: 0.8,
                                    color: color[x] + ', 0)'
                                }], false),
                                shadowColor: 'rgba(0, 0, 0, 0.1)',
                                shadowBlur: 10
                            }
                        },
                        symbol: 'circle',
                        symbolSize: 9,
                        data: charts.value
                    }
                    lineY.push(data)
                }
                lineY[0].markLine = {
                    silent: true,
                    data: [{ yAxis: 400 }]
                }
                var option = {

                    title: {
                        textStyle: {
                            fontWeight: 'normal',
                            fontSize: 16,
                            color: '#F1F1F3'
                        },
                        left: '6%',
                        top: '4%'
                    },
                    backgroundColor: 'rgba(0, 0, 0, 0)',
                    tooltip: {
                        trigger: 'axis'
                    },

                    legend: {
                        top: '4%',
                        data: charts.names,
                        textStyle: {
                            fontSize: 14,
                            color: 'F1F1F3'
                        },
                        right: '4%'
                    },
                    grid: {
                        top: '10%',
                        left: '4%',
                        right: '4%',
                        bottom: '10%',
                        containLabel: true
                    },
                    xAxis: {
                        show: true,
                        type: 'category',
                        boundaryGap: false,
                        data: charts.lineX,
                        axisLabel: {
                            textStyle: {
                                color: 'rgb(0,0,0)'
                            },
                        }
                    },
                    yAxis: {
                        show: true,
                        splitArea: {
                            show: true,
                            areaStyle: {
                                color: "rgba(0, 0, 0, 0)"
                            }
                        },
                        name: charts.unit,
                        type: 'value',
                        axisLabel: {
                            formatter: '{value}',
                            textStyle: {
                                color: 'rgb(0,0,0,0.6)'
                            }
                        },
                        splitLine: {
                            lineStyle: {
                                color: 'rgb(0,0,0,0.3)'
                            }
                        },

                        axisLine: {
                            show: true,
                            lineStyle: {
                                color: 'rgb(0,0,0,0.6)'
                            }
                        }
                    },
                    series: lineY
                }
                myChart.setOption(option);

                // 在这里，你可以使用 charts 对象进行后续操作
            }
        });
    }




</script>
<!-- 柱状图 -->
<script>
    var dingdanlist;
    var currentPage = 1;
    var currentsize = 1;
    var time = [];

    $(function () {
        getdingdan();
        $('#tododay').click(tododay);
        $('#houtian').click(houtian);
        $('#jinqi').click(jinqi);
        $('#jinsan').click(jinsan);
    });

    function tododay() {
        currentPage = 1;
        currentsize = 3;
        time = []; // 重置时间数组
        let data = {
            page: currentPage,
            size: currentsize,
        };
        getdingdan(data);
    }

    function houtian() {
        currentPage = 2;
        currentsize = 7;
        time = []; // 重置时间数组
        let data = {
            page: currentPage,
            size: currentsize,
        };
        getdingdan(data);
    }

    function jinqi() {
        currentPage = 1;
        currentsize = 12;
        time = []; // 重置时间数组
        let data = {
            page: currentPage,
            size: currentsize,
        };
        getdingdan(data);
    }

    function jinsan() {
        currentPage = 1;
        currentsize = 20;
        time = []; // 重置时间数组
        let data = {
            page: currentPage,
            size: currentsize,
        };
        getdingdan(data);
    }

    function getdingdan(data) {
        $.ajax({
            url: URL + "/dingdan",
            type: "get",
            data: data,
            dataType: "json",
            success: function (res) {
                console.log(res);
                dingdanlist = res.map(item => Number(item.unit));
                res.forEach(item => {
                    if (item.c_time) {
                        time.push(item.c_time.substring(0, 10));
                    }
                });
                var myChart = echarts.init(document.querySelector('.zhuangtu'));
                option = {
                    xAxis: {
                        type: 'category',
                        data: time
                    },
                    yAxis: {
                        type: 'value'
                    },
                    tooltip: {
                        trigger: 'axis',
                        axisPointer: {
                            type: 'shadow'
                        }
                    },
                    series: [
                        {
                            data: dingdanlist,
                            type: 'bar'
                        }
                    ]
                };
                myChart.setOption(option);
            }
        });
    }


</script>
<!-- 折线图 -->
<script>
    var myChart = echarts.init(document.querySelector('.operate-right'));

    var data = [
        [1, 1],
        [2, 1],
        [3, 4],
        [4, 7],
        [5, 2],
        [6, 2],
        [7, 4],
        [8, 3],
        [10, 1],
        [11, 3],
        [12, 1],
        [13, 1],
        [14, 4],
        [15, 3],
        [16, 1],
        [18, 1],
        [20, 2],
        [22, 2],
        [23, 1],
        [25, 1],
        [26, 1],
        [27, 4],
        [29, 2],
        [30, 1],
        [31, 1],
        [32, 2],
        [34, 2],
        [35, 3.5],
        [36, 5],
        [37, 3],
        [38, 2],
        [42, 2],
        [43, 1],
        [46, 1],
        [47, 1],
        [48, 3],
        [51, 1],
        [53, 1],
        [56, 1],
        [62, 2],
        [63, 2],
        [65, 3],
        [66, 1],
        [67, 1],
        [68, 2],
        [69, 1],
        [70, 1],
        [71, 1],
        [75, 1],
        [77, 1],
        [83, 1],
        [85, 2],
        [86, 1],
        [88, 1],
        [91, 1],
        [96, 1],
        [104, 1],
        [106, 1]
    ];

    option = {
        xAxis: {
            name: '天',
            type: 'value',
            interval: 10, // 步长
            min: 0, // 起始
            max: 80 // 终止
        },
        tooltip: {
            trigger: 'axis',
            formatter: function (params) {
                return 'x:' + params[0].axisValue + ',y:' + params[0].data[1]
            }
        },
        yAxis: {
            name: '合同数',
            type: 'value',
            interval: 1, // 步长
            min: 0, // 起始
            max: 8 // 终止
        },
        series: [{
            type: 'line',
            smooth: true,
            showSymbol: false, //隐藏圆点
            data: data
        }]
    };

    myChart.setOption(option);

</script>
<!-- 柱状图 -->
<script>
    var myChart = echarts.init(document.querySelector('.zhuzhaungtu'));

    var option = {
        tooltip: {
            trigger: "axis",
            axisPointer: {
                // 坐标轴指示器，坐标轴触发有效
                type: "line", // 默认为直线，可选为：'line' | 'shadow'
            },
            textStyle: {
                align: "left",
            },
            formatter: "{b} : {c}人"
            //  formatter: function(item) {
            //      return (
            //          item[0].name + "：" + that.formatNumberRgx(item[0].value) + "人"
            //      );
            //  },
        },

        grid: {
            top: "15%",
            left: "3%",
            right: "4%",
            bottom: "3%",
            containLabel: true,
        },
        xAxis: [{
            // type: "category",s
            axisTick: {
                //x轴刻度线
                show: false,
            },
            axisLine: {
                lineStyle: {
                    color: "#E2E2E2", // 颜色
                },
            },
            interval: 0,
            axisLabel: {
                textStyle: {
                    color: "#737373",
                    fontSize: 12,
                },
                //  rotate: 40,
            },
            data: [2014, 2015, 2016, 2017, 2018, 2019],
        },],
        yAxis: [{
            type: "value",
            name: "个",
            axisTick: {
                //y轴刻度线
                show: false,
            },
            nameTextStyle: {
                color: "#252525",
                fontSize: 12,
                padding: [0, 0, 0, -50],
            },
            axisLine: {
                lineStyle: {
                    color: "#E2E2E2", // 颜色
                },
            },
            axisLabel: {
                interval: 0,
                textStyle: {
                    color: "#737373",
                    fontSize: 12,
                },
            },
        },],
        series: [{
            type: "bar",
            barWidth: 12,
            itemStyle: {
                label: {
                    textStyle: {
                        color: "#800080",
                    },
                },
                normal: {
                    //柱形图圆角，初始化效果
                    barBorderRadius: [10, 10, 0, 0],
                    color: "#62AAFD",
                },
            },
            data: [545, 545, 989, 549, 98, 568, 666, 784, 556],
        },],
    };

    myChart.setOption(option);

</script>
<!-- 饼图 -->
<script>
    var myChart = echarts.init(document.querySelector('.bingtu'));

    option = {
        title: {
            text: '推广大使',
            left: '40%',
            top: 'center',
            textAlign: 'center',
        },
        tooltip: {
            trigger: 'item',
            formatter: '{a} <br/>{b}: {c} ({d}%)',
        },
        legend: {
            orient: 'vertical',
            right: 10,
            top: 'center',
            data: ['推广大使VIP', '宝妈大使', '宝妈会员', '视频广告', '搜索引擎'],
        },
        series: [
            {
                center: ['40%', '50%'],
                name: '访问来源',
                type: 'pie',
                radius: ['50%', '70%'],
                avoidLabelOverlap: false,
                label: {
                    show: false,
                    position: 'center',
                },
                emphasis: {
                    label: {
                        show: true,
                        fontSize: '30',
                        fontWeight: 'bold',
                    },
                },
                labelLine: {
                    show: false,
                },
                data: [
                    { value: 335, name: '推广大使VIP', itemStyle: { color: '#ff9ff3' } },
                    { value: 310, name: '宝妈大使', itemStyle: { color: '#feca57' } },
                    { value: 234, name: '宝妈会员', itemStyle: { color: '#ff6b6b' } },
                ],
            },
        ],
    };
    myChart.setOption(option);

</script>
<!-- 折线图 -->
<script>
    var myChart = echarts.init(document.querySelector('.flow-right'));

    option = {
        title: {
            text: '护理单数量（单）',
            textStyle: { color: '#666', fontSize: 14, fontWeight: 'normal' },
            padding: [5, 0, 0, 0],
        },
        legend: {
            type: 'plain',
            top: 0,
            right: 20,
            itemGap: 64,
            itemWidth: 10,
            icon: 'circle',
            selectedMode: false,
            textStyle: { padding: [0, 0, 0, 4] },
            data: ['PV', 'UV'],
        },
        grid: { left: 0, top: 40, bottom: 20, right: 10, containLabel: true },
        xAxis: {
            type: 'category',
            data: [
                '12-26',
                '12-27',
                '12-28',
                '12-29',
                '12-30',
                '12-31',
                '01-01',
                '01-02',
                '01-03',
                '01-04',
                '01-05',
                '01-06',
                '01-07',
                '01-08',
                '01-09',
            ],
            axisLine: { lineStyle: { color: '#ccc' } },
            axisTick: { length: 3 },
            axisLabel: { color: '#999' },
        },
        yAxis: {
            type: 'value',
            axisLine: { show: true, lineStyle: { color: '#ccc' } },
            axisLabel: { color: '#999' },
            splitLine: { show: false },
        },
        tooltip: {
            trigger: 'axis',
            padding: [12, 17, 20, 23],
            textStyle: { color: '#424242' },
            renderMode: 'html',
            className: 'tooltip',
        },
        series: [
            {
                name: 'PV',
                type: 'line',
                data: [0, 10, 2, 4, 4, 7, 0, 0, 0, 3, 0, 9, 6, 0, 0],
                smooth: true, // 平滑曲线
                showSymbol: false,
                itemStyle: { color: '#126EFC' },
                lineStyle: { width: 3, color: '#126EFC' },
                areaStyle: { color: 'rgba(0, 110, 254, 0.1)' },
            },
            {
                name: 'UV',
                type: 'line',
                data: [0, 0, 0, 5, 0, 2, 0, 0, 0, 2, 0, 4, 1, 0, 0],
                smooth: true,
                showSymbol: false,
                itemStyle: { color: '#1BB389' },
                lineStyle: { width: 3, color: '#1BB389' },
                areaStyle: { color: 'rgba(27, 179, 137, 0.1)' },
            },
        ],
    };
    myChart.setOption(option);

</script>

</html>